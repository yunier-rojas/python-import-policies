release:
  image: node:bookworm
  stage: release
  variables:
    GITLAB_TOKEN: ${{ GITLAB_TOKEN }}
    PYPI_TOKEN: ${{ PYPI_TOKEN }}
  before_script:
    - npm install
    - apt-get update && apt-get install -y python3-pip
    - git remote set-url --push origin https://gitlab-ci-token:${GITLAB_TOKEN}@gitlab.com/$CI_PROJECT_PATH.git
    - python3 --version
    - pip --version
    - rm /usr/lib/python3.11/EXTERNALLY-MANAGED
  script:
    - npx semantic-release
